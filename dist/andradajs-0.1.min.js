/*
* Basic websocket wrapper
* Andrada.Core.Networking.Socket
*/
gamecore.Base.extend("Andrada.Core.Networking.Socket",{},{CONNECTING:0,OPEN:0,CLOSING:2,CLOSED:3,HEARTBEAT_DELAY:2e4,websocket:null,isClosed:!0,readyState:3,hearbeat:null,delay:80,delayMax:1e4,init:function(e){isClosed=!1,readyState=CONNECTING,websocket=_getUnderlyingSocket();if(!websocket)return this.ondisconnect(),!1;websocket.onopen=_transportonopen,websocket.onclose=_transportonclose,websocket.onmessage=_transportonmessage,websocket.onerror=_transportonclose},_getUnderlyingSocket:function(){return window.WebSocket?window.WebSocket:!1},send:function(e){if(websocket){if(!packet.isA("Packet"))throw new Error(Andrada.Core.Networking.Exceptions.NOT_A_PACKET_EXCEPTION);return websocket.send(e)}return!1},close:function(){websocket&&(readyState=CLOSING,websocket.close())},_transportonopen:function(){this.heartbeat=setInterval(function(){this.onheartbeat()},HEARTBEAT_DELAY),readyState!=OPEN&&(readyState=OPEN,this.onopen())},_transportonclose:function(){clearInterval(this.heartbeat),readyState=CLOSED,this.onclose()},_transportonmessage:function(e){this.onmessage(e)},onopen:function(){},onclose:function(){},ondisconnect:function(){},onmessage:function(){},onheartbeat:function(){}}),gamecore.Base.extend("Andrada.Core.Networking.Packet",{},{});
