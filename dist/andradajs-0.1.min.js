/*
* Basic websocket wrapper
* Andrada.Core.Networking.Socket
*/
gamecore.Base.extend("Andrada.Core.Networking.Socket",{CONNECTING:0,OPEN:0,CLOSING:2,CLOSED:3,HEARTBEAT_DELAY:2e4},{websocket:null,isClosed:!0,readyState:3,hearbeat:null,delay:80,delayMax:1e4,init:function(e){this.isClosed=!1,this.readyState=Andrada.Core.Networking.Socket.CONNECTING,this.websocket=new(this._getUnderlyingSocket())(e);if(!this.websocket)return this.ondisconnect(),!1;this.websocket.onopen=this._transportonopen,this.websocket.onclose=this._transportonclose,this.websocket.onmessage=this._transportonmessage,this.websocket.onerror=this._transportonclose,this.websocket.wrapper=this},_getUnderlyingSocket:function(){return window.WebSocket?window.WebSocket:!1},send:function(e){if(this.websocket){if(!e.isA("Packet"))throw new Error(Andrada.Core.Networking.Exceptions.NOT_A_PACKET_EXCEPTION);return this.websocket.send(e)}return!1},close:function(){this.websocket&&(this.readyState=Andrada.Core.Networking.Socket.CLOSING,this.websocket.close())},_transportonopen:function(){this.wrapper.heartbeat=setInterval(function(){this.wrapper.onheartbeat()},Andrada.Core.Networking.Socket.HEARTBEAT_DELAY),this.wrapper.readyState!=Andrada.Core.Networking.Socket.OPEN&&(this.wrapper.readyState=Andrada.Core.Networking.Socket.OPEN,this.wrapper.onopen())},_transportonclose:function(){clearInterval(this.wrapper.heartbeat),this.wrapper.readyState=Andrada.Core.Networking.Socket.CLOSED,this.wrapper.onclose()},_transportonmessage:function(e){this.wrapper.onmessage(e)},onopen:function(){},onclose:function(){},ondisconnect:function(){},onmessage:function(){},onheartbeat:function(){}}),gamecore.Base.extend("Andrada.Core.Networking.Packet",{},{}),gamecore.Base.extend("Andrada.Core.Networking.PacketHandler",{register:function(e,t){}},{init:function(){}});
